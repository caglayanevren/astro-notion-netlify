---
export const prerender = true;

import ImageWrapper  from '@components/misc/ImageWrapper.astro';
import  Layout from "@layouts/Layout.astro";
import { getNotionPosts } from '@utils/notion';
import { type BlogPostDataType } from '../config';

const allPosts = await getNotionPosts();
// Sadece 'Published' olanları çek ve tarihe göre sırala
//const filteredPosts = allPosts.filter(post => post.data.Status === 'Published');
  const sortedPosts = allPosts.sort((a: { data: BlogPostDataType }, b: { data: BlogPostDataType }) => {
	const dateA = a.data.Date;
	const dateB = b.data.Date;
	if(dateA && dateB) 
	return dateA > dateB ? -1 : 1;
	return 0;
  });

---
<Layout>
	<h1>Blog Yazıları</h1>
	<ul style="list-style-type: none;">
	  {sortedPosts.map(post => (
		<li>
			<div style="display: flex;">
				<div style="height: 280px;padding-inline:10px">{post.data.Image && <ImageWrapper src={post.data.Image} alt={post.data.Name} />}</div>
				<a href={`/blog/${post.data.Slug}`}>
					<h2>{post.data.Name}</h2>
					<p>{post.data.Summary}</p>
					<time>{post.data.Date?.start?.toLocaleDateString()}</time>
				</a>
			</div>
		</li>
	  ))}
	</ul>
</Layout>